# SAPI For VOICEVOX
Windows標準の音声合成機能の音声としてVOICEVOXが追加ができます。  
![コンパネ音声合成](https://user-images.githubusercontent.com/32050537/131860902-7aedbd45-453a-4425-a33c-7cb4a2f2dcf1.png)  
SAPI5対応のアプリケーションから使用することができます。  

32bit版は、棒読みちゃんでテストしています。  
64bit版は、やります！アンコちゃんでテストしています。  

# 使用方法
GitHubのReleaseからダウンロードができます。  
setup.exeを起動し、インストールしてください。  
32bit版と64bit版が存在します。使用したいアプリケーションに応じて選択してください。  
両方インストールすることもできます。その場合、同じ場所にインストールしないでください。  
インストール場所の初期値は「c:\SAPIForVOICEVOX(32or64)」になっています。  
「C:\Program Files (x86)」へインストールしないでください。何故か正常にインストールできません。  

VOICEVOX本体が必要です。[VOICEVOX公式ホームページ](https://voicevox.hiroshiba.jp/)  
VOICEVOXエンジンの自動起動機能は実装していないので、あらかじめVOICEVOXを起動しておいてください。  

Windows Defender にウイルスとして検知されてしまうと報告をうけています。  
当ソフトには、ウイルスは含まれていませんので、誤検知です。  
ソースコードを公開しているので、そこから判断していただくと幸いです。  
ちなみに、ウイルスバスターでは、「脅威無し」の判定でした。    

# 開発環境
Microsoft Visual Studio Community 2019  
C#・C++

# ビルド方法
ソリューションを開き、ビルドを実行します。  
~~自動でCOMとして登録されます。SAPIに必要なレジストリの登録も自動で実行されます。~~  
インストーラプロジェクトを追加したので、ビルド時にレジストリ登録する機能はオフにしました。  
インストーラプロジェクトは自動でビルドされません。ソリューションエクスプローラーからSetupを右クリックしてビルドを選択し、ビルドしてください。  
同じく、Setupを右クリックしてインストールを選択すると、インストールができます。  

インストーラのビルドには、「Microsoft Visual Studio Installer Projects」の拡張機能が必要です。  
Visual Studioの「ツール」→「拡張機能」からインストールしてください。  

# 追加したい機能等
- [x] インストーラ作成。  
- [x] VOICEVOXエンジンが見つからない場合に、音声で知らせる機能。  

他、issueにあります。
